{"remainingRequest":"D:\\数瀛信息科技\\公司项目\\广州西门子原材料立体库\\低压线圈\\src\\LES.Vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\数瀛信息科技\\公司项目\\广州西门子原材料立体库\\低压线圈\\src\\LES.Vue\\src\\components\\ToolbarExport.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\数瀛信息科技\\公司项目\\广州西门子原材料立体库\\低压线圈\\src\\LES.Vue\\src\\components\\ToolbarExport.vue","mtime":1611215548477},{"path":"D:\\数瀛信息科技\\公司项目\\广州西门子原材料立体库\\低压线圈\\src\\LES.Vue\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\数瀛信息科技\\公司项目\\广州西门子原材料立体库\\低压线圈\\src\\LES.Vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\数瀛信息科技\\公司项目\\广州西门子原材料立体库\\低压线圈\\src\\LES.Vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport FileSaver from 'file-saver'\r\nimport XLSX from 'xlsx'\r\nexport default {\r\n  name: \"ToolbarExport\",\r\n  data () {\r\n    return {\r\n    };\r\n  },\r\n  props: {\r\n    //接受父组件传值\r\n    filterVal: {\r\n      type: Array,\r\n      required: true,\r\n    },\r\n    tHeader: {\r\n      type: Array,\r\n      required: true,\r\n    },\r\n    currentPageData: {\r\n      type: Array,\r\n      required: true,\r\n    },\r\n    printDialogVisible: {\r\n      type: Boolean,\r\n      required: true,\r\n    }\r\n  },\r\n  methods: {\r\n    // 仅导出本页\r\n    exprotCurPage () {\r\n      this.export2Excel(this.currentPageData)\r\n    },\r\n    // 导出全部\r\n    exprotAll () {\r\n      // 获取全部数据\r\n      var data = this.getPostParam('2')  // 1代表查询 2代表 全部导出\r\n\r\n      // 获取数据\r\n      getCurExecTaskList(data)\r\n        .then(res => {\r\n          this.export2Excel(res.resData.rows)\r\n          this.curLoading.close()\r\n        })\r\n        .catch(err => {\r\n          console.log(err)\r\n          this.curLoading.close()\r\n        })\r\n    },\r\n    // 导出Excel表格\r\n    export2Excel (exportData) {\r\n      var text = '导出中...'\r\n      this.loadingToload(text)\r\n      require.ensure([], () => {\r\n        const { export_json_to_excel } = require('../vendor/Export2Excel') // Export2Excel.js路径\r\n        const list = exportData // 数据源\r\n        const data = this.formatJson(this.filterVal, list) // 数据为json格式\r\n        export_json_to_excel(this.tHeader, data, '计划跟踪信息(' + getNowFormatDateForExport() + ')') // 导出表格名字\r\n        this.$notify({\r\n          title: '导出成功',\r\n          message: '计划跟踪信息导出成功',\r\n          type: 'success'\r\n        })\r\n        this.printDialogVisible = false\r\n        this.curLoading.close()\r\n      })\r\n    }\r\n  }\r\n};\r\n",{"version":3,"sources":["ToolbarExport.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAkBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ToolbarExport.vue","sourceRoot":"src\\components","sourcesContent":["<template>\r\n  <el-dialog title=\"提示\"\r\n             :visible.sync=\"printDialogVisible\"\r\n             width=\"30%\"\r\n             center>\r\n    <span>请选择导出范围</span>\r\n    <span slot=\"footer\"\r\n          class=\"dialog-footer\">\r\n      <el-button type=\"primary\"\r\n                 @click=\"exprotCurPage\">仅 本 页 导 出</el-button>\r\n      <el-button type=\"success\"\r\n                 @click=\"exprotAll\">全 部 导 出</el-button>\r\n      <el-button @click=\"printDialogVisible = false\">取 消 导 出</el-button>\r\n\r\n    </span>\r\n  </el-dialog>\r\n</template>\r\n<script>\r\nimport FileSaver from 'file-saver'\r\nimport XLSX from 'xlsx'\r\nexport default {\r\n  name: \"ToolbarExport\",\r\n  data () {\r\n    return {\r\n    };\r\n  },\r\n  props: {\r\n    //接受父组件传值\r\n    filterVal: {\r\n      type: Array,\r\n      required: true,\r\n    },\r\n    tHeader: {\r\n      type: Array,\r\n      required: true,\r\n    },\r\n    currentPageData: {\r\n      type: Array,\r\n      required: true,\r\n    },\r\n    printDialogVisible: {\r\n      type: Boolean,\r\n      required: true,\r\n    }\r\n  },\r\n  methods: {\r\n    // 仅导出本页\r\n    exprotCurPage () {\r\n      this.export2Excel(this.currentPageData)\r\n    },\r\n    // 导出全部\r\n    exprotAll () {\r\n      // 获取全部数据\r\n      var data = this.getPostParam('2')  // 1代表查询 2代表 全部导出\r\n\r\n      // 获取数据\r\n      getCurExecTaskList(data)\r\n        .then(res => {\r\n          this.export2Excel(res.resData.rows)\r\n          this.curLoading.close()\r\n        })\r\n        .catch(err => {\r\n          console.log(err)\r\n          this.curLoading.close()\r\n        })\r\n    },\r\n    // 导出Excel表格\r\n    export2Excel (exportData) {\r\n      var text = '导出中...'\r\n      this.loadingToload(text)\r\n      require.ensure([], () => {\r\n        const { export_json_to_excel } = require('../vendor/Export2Excel') // Export2Excel.js路径\r\n        const list = exportData // 数据源\r\n        const data = this.formatJson(this.filterVal, list) // 数据为json格式\r\n        export_json_to_excel(this.tHeader, data, '计划跟踪信息(' + getNowFormatDateForExport() + ')') // 导出表格名字\r\n        this.$notify({\r\n          title: '导出成功',\r\n          message: '计划跟踪信息导出成功',\r\n          type: 'success'\r\n        })\r\n        this.printDialogVisible = false\r\n        this.curLoading.close()\r\n      })\r\n    }\r\n  }\r\n};\r\n</script>"]}]}