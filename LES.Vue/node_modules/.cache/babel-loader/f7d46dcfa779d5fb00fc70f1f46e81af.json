{"remainingRequest":"D:\\数瀛信息科技\\公司项目\\广州西门子原材料立体库\\低压线圈\\src\\LES.Vue\\node_modules\\thread-loader\\dist\\cjs.js!D:\\数瀛信息科技\\公司项目\\广州西门子原材料立体库\\低压线圈\\src\\LES.Vue\\node_modules\\babel-loader\\lib\\index.js!D:\\数瀛信息科技\\公司项目\\广州西门子原材料立体库\\低压线圈\\src\\LES.Vue\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\数瀛信息科技\\公司项目\\广州西门子原材料立体库\\低压线圈\\src\\LES.Vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\数瀛信息科技\\公司项目\\广州西门子原材料立体库\\低压线圈\\src\\LES.Vue\\src\\components\\ToolbarExport.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\数瀛信息科技\\公司项目\\广州西门子原材料立体库\\低压线圈\\src\\LES.Vue\\src\\components\\ToolbarExport.vue","mtime":1611215548477},{"path":"D:\\数瀛信息科技\\公司项目\\广州西门子原材料立体库\\低压线圈\\src\\LES.Vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\数瀛信息科技\\公司项目\\广州西门子原材料立体库\\低压线圈\\src\\LES.Vue\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\数瀛信息科技\\公司项目\\广州西门子原材料立体库\\低压线圈\\src\\LES.Vue\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\数瀛信息科技\\公司项目\\广州西门子原材料立体库\\低压线圈\\src\\LES.Vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\数瀛信息科技\\公司项目\\广州西门子原材料立体库\\低压线圈\\src\\LES.Vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport FileSaver from 'file-saver';\nimport XLSX from 'xlsx';\nexport default {\n  name: \"ToolbarExport\",\n  data: function data() {\n    return {};\n  },\n  props: {\n    //接受父组件传值\n    filterVal: {\n      type: Array,\n      required: true\n    },\n    tHeader: {\n      type: Array,\n      required: true\n    },\n    currentPageData: {\n      type: Array,\n      required: true\n    },\n    printDialogVisible: {\n      type: Boolean,\n      required: true\n    }\n  },\n  methods: {\n    // 仅导出本页\n    exprotCurPage: function exprotCurPage() {\n      this.export2Excel(this.currentPageData);\n    },\n    // 导出全部\n    exprotAll: function exprotAll() {\n      var _this = this;\n\n      // 获取全部数据\n      var data = this.getPostParam('2'); // 1代表查询 2代表 全部导出\n      // 获取数据\n\n      getCurExecTaskList(data).then(function (res) {\n        _this.export2Excel(res.resData.rows);\n\n        _this.curLoading.close();\n      }).catch(function (err) {\n        console.log(err);\n\n        _this.curLoading.close();\n      });\n    },\n    // 导出Excel表格\n    export2Excel: function export2Excel(exportData) {\n      var _this2 = this;\n\n      var text = '导出中...';\n      this.loadingToload(text);\n\n      require.ensure([], function () {\n        var _require = require('../vendor/Export2Excel'),\n            export_json_to_excel = _require.export_json_to_excel; // Export2Excel.js路径\n\n\n        var list = exportData; // 数据源\n\n        var data = _this2.formatJson(_this2.filterVal, list); // 数据为json格式\n\n\n        export_json_to_excel(_this2.tHeader, data, '计划跟踪信息(' + getNowFormatDateForExport() + ')'); // 导出表格名字\n\n        _this2.$notify({\n          title: '导出成功',\n          message: '计划跟踪信息导出成功',\n          type: 'success'\n        });\n\n        _this2.printDialogVisible = false;\n\n        _this2.curLoading.close();\n      });\n    }\n  }\n};",{"version":3,"sources":["ToolbarExport.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAkBA,OAAA,SAAA,MAAA,YAAA;AACA,OAAA,IAAA,MAAA,MAAA;AACA,eAAA;AACA,EAAA,IAAA,EAAA,eADA;AAEA,EAAA,IAFA,kBAEA;AACA,WAAA,EAAA;AAEA,GALA;AAMA,EAAA,KAAA,EAAA;AACA;AACA,IAAA,SAAA,EAAA;AACA,MAAA,IAAA,EAAA,KADA;AAEA,MAAA,QAAA,EAAA;AAFA,KAFA;AAMA,IAAA,OAAA,EAAA;AACA,MAAA,IAAA,EAAA,KADA;AAEA,MAAA,QAAA,EAAA;AAFA,KANA;AAUA,IAAA,eAAA,EAAA;AACA,MAAA,IAAA,EAAA,KADA;AAEA,MAAA,QAAA,EAAA;AAFA,KAVA;AAcA,IAAA,kBAAA,EAAA;AACA,MAAA,IAAA,EAAA,OADA;AAEA,MAAA,QAAA,EAAA;AAFA;AAdA,GANA;AAyBA,EAAA,OAAA,EAAA;AACA;AACA,IAAA,aAFA,2BAEA;AACA,WAAA,YAAA,CAAA,KAAA,eAAA;AACA,KAJA;AAKA;AACA,IAAA,SANA,uBAMA;AAAA;;AACA;AACA,UAAA,IAAA,GAAA,KAAA,YAAA,CAAA,GAAA,CAAA,CAFA,CAEA;AAEA;;AACA,MAAA,kBAAA,CAAA,IAAA,CAAA,CACA,IADA,CACA,UAAA,GAAA,EAAA;AACA,QAAA,KAAA,CAAA,YAAA,CAAA,GAAA,CAAA,OAAA,CAAA,IAAA;;AACA,QAAA,KAAA,CAAA,UAAA,CAAA,KAAA;AACA,OAJA,EAKA,KALA,CAKA,UAAA,GAAA,EAAA;AACA,QAAA,OAAA,CAAA,GAAA,CAAA,GAAA;;AACA,QAAA,KAAA,CAAA,UAAA,CAAA,KAAA;AACA,OARA;AASA,KApBA;AAqBA;AACA,IAAA,YAtBA,wBAsBA,UAtBA,EAsBA;AAAA;;AACA,UAAA,IAAA,GAAA,QAAA;AACA,WAAA,aAAA,CAAA,IAAA;;AACA,MAAA,OAAA,CAAA,MAAA,CAAA,EAAA,EAAA,YAAA;AAAA,uBACA,OAAA,CAAA,wBAAA,CADA;AAAA,YACA,oBADA,YACA,oBADA,EACA;;;AACA,YAAA,IAAA,GAAA,UAAA,CAFA,CAEA;;AACA,YAAA,IAAA,GAAA,MAAA,CAAA,UAAA,CAAA,MAAA,CAAA,SAAA,EAAA,IAAA,CAAA,CAHA,CAGA;;;AACA,QAAA,oBAAA,CAAA,MAAA,CAAA,OAAA,EAAA,IAAA,EAAA,YAAA,yBAAA,EAAA,GAAA,GAAA,CAAA,CAJA,CAIA;;AACA,QAAA,MAAA,CAAA,OAAA,CAAA;AACA,UAAA,KAAA,EAAA,MADA;AAEA,UAAA,OAAA,EAAA,YAFA;AAGA,UAAA,IAAA,EAAA;AAHA,SAAA;;AAKA,QAAA,MAAA,CAAA,kBAAA,GAAA,KAAA;;AACA,QAAA,MAAA,CAAA,UAAA,CAAA,KAAA;AACA,OAZA;AAaA;AAtCA;AAzBA,CAAA","sourcesContent":["<template>\r\n  <el-dialog title=\"提示\"\r\n             :visible.sync=\"printDialogVisible\"\r\n             width=\"30%\"\r\n             center>\r\n    <span>请选择导出范围</span>\r\n    <span slot=\"footer\"\r\n          class=\"dialog-footer\">\r\n      <el-button type=\"primary\"\r\n                 @click=\"exprotCurPage\">仅 本 页 导 出</el-button>\r\n      <el-button type=\"success\"\r\n                 @click=\"exprotAll\">全 部 导 出</el-button>\r\n      <el-button @click=\"printDialogVisible = false\">取 消 导 出</el-button>\r\n\r\n    </span>\r\n  </el-dialog>\r\n</template>\r\n<script>\r\nimport FileSaver from 'file-saver'\r\nimport XLSX from 'xlsx'\r\nexport default {\r\n  name: \"ToolbarExport\",\r\n  data () {\r\n    return {\r\n    };\r\n  },\r\n  props: {\r\n    //接受父组件传值\r\n    filterVal: {\r\n      type: Array,\r\n      required: true,\r\n    },\r\n    tHeader: {\r\n      type: Array,\r\n      required: true,\r\n    },\r\n    currentPageData: {\r\n      type: Array,\r\n      required: true,\r\n    },\r\n    printDialogVisible: {\r\n      type: Boolean,\r\n      required: true,\r\n    }\r\n  },\r\n  methods: {\r\n    // 仅导出本页\r\n    exprotCurPage () {\r\n      this.export2Excel(this.currentPageData)\r\n    },\r\n    // 导出全部\r\n    exprotAll () {\r\n      // 获取全部数据\r\n      var data = this.getPostParam('2')  // 1代表查询 2代表 全部导出\r\n\r\n      // 获取数据\r\n      getCurExecTaskList(data)\r\n        .then(res => {\r\n          this.export2Excel(res.resData.rows)\r\n          this.curLoading.close()\r\n        })\r\n        .catch(err => {\r\n          console.log(err)\r\n          this.curLoading.close()\r\n        })\r\n    },\r\n    // 导出Excel表格\r\n    export2Excel (exportData) {\r\n      var text = '导出中...'\r\n      this.loadingToload(text)\r\n      require.ensure([], () => {\r\n        const { export_json_to_excel } = require('../vendor/Export2Excel') // Export2Excel.js路径\r\n        const list = exportData // 数据源\r\n        const data = this.formatJson(this.filterVal, list) // 数据为json格式\r\n        export_json_to_excel(this.tHeader, data, '计划跟踪信息(' + getNowFormatDateForExport() + ')') // 导出表格名字\r\n        this.$notify({\r\n          title: '导出成功',\r\n          message: '计划跟踪信息导出成功',\r\n          type: 'success'\r\n        })\r\n        this.printDialogVisible = false\r\n        this.curLoading.close()\r\n      })\r\n    }\r\n  }\r\n};\r\n</script>"],"sourceRoot":"src\\components"}]}