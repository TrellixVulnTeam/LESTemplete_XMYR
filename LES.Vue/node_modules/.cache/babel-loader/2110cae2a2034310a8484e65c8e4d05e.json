{"remainingRequest":"D:\\数瀛信息科技\\公司项目\\广州西门子原材料立体库\\低压线圈\\src\\LES.Vue\\node_modules\\babel-loader\\lib\\index.js!D:\\数瀛信息科技\\公司项目\\广州西门子原材料立体库\\低压线圈\\src\\LES.Vue\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\数瀛信息科技\\公司项目\\广州西门子原材料立体库\\低压线圈\\src\\LES.Vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\数瀛信息科技\\公司项目\\广州西门子原材料立体库\\低压线圈\\src\\LES.Vue\\src\\components\\ToolbarExport.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\数瀛信息科技\\公司项目\\广州西门子原材料立体库\\低压线圈\\src\\LES.Vue\\src\\components\\ToolbarExport.vue","mtime":1611282930470},{"path":"D:\\数瀛信息科技\\公司项目\\广州西门子原材料立体库\\低压线圈\\src\\LES.Vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\数瀛信息科技\\公司项目\\广州西门子原材料立体库\\低压线圈\\src\\LES.Vue\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\数瀛信息科技\\公司项目\\广州西门子原材料立体库\\低压线圈\\src\\LES.Vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\数瀛信息科技\\公司项目\\广州西门子原材料立体库\\低压线圈\\src\\LES.Vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport XLSX, { WorkSheet } from \"xlsx\";\nimport { getNowFormatDateForExport } from '../../util/tools';\nexport default {\n  name: \"ToolbarExport\",\n  data: function data() {\n    return {\n      sonPrintDialogVisible: false\n    };\n  },\n  props: {\n    exportFileName: {\n      type: String,\n      required: true\n    },\n    //接受父组件传值\n    filterVal: {\n      type: Array,\n      required: true\n    },\n    tHeader: {\n      type: Array,\n      required: true\n    },\n    currentPageData: {\n      type: Array,\n      required: true\n    }\n  },\n  methods: {\n    showPrintPage: function showPrintPage() {\n      this.sonPrintDialogVisible = true;\n    },\n    // 仅导出本页\n    exprotCurPage: function exprotCurPage() {\n      this.export2Excel(this.currentPageData);\n    },\n    // 导出全部\n    exprotAll: function exprotAll() {\n      this.$parent.exportAllData();\n    },\n\n    /** 加载方法 */\n    loadingToload: function loadingToload(text) {\n      var loading = this.$loading({\n        lock: true,\n        text: text,\n        spinner: 'el-icon-loading',\n        background: 'rgba(255, 255, 255, 0.8)',\n        target: document.querySelector('#mainDiv')\n      });\n      this.curLoading = loading;\n    },\n    // 导出Excel表格\n    export2Excel: function export2Excel(exportData) {\n      var _this = this;\n\n      var text = this.exportFileName + '导出中...';\n      this.loadingToload(text);\n\n      require.ensure([], function () {\n        var _require = require('../../util/Export2Excel.js'),\n            export_json_to_excel = _require.export_json_to_excel; // Export2Excel.js路径\n\n\n        var list = exportData; // 数据源\n\n        var data = _this.formatJson(_this.filterVal, list); // 数据为json格式\n\n\n        export_json_to_excel(_this.tHeader, data, _this.exportFileName + '(' + getNowFormatDateForExport() + ')'); // 导出表格名字\n\n        _this.$notify({\n          title: '导出成功',\n          message: _this.exportFileName + '导出成功',\n          type: 'success'\n        });\n\n        _this.sonPrintDialogVisible = false;\n\n        _this.curLoading.close();\n      });\n    },\n    formatJson: function formatJson(filterVal, jsonData) {\n      return jsonData.map(function (v) {\n        return filterVal.map(function (j) {\n          return v[j];\n        });\n      });\n    }\n  }\n};",{"version":3,"sources":["ToolbarExport.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAkBA,OAAA,IAAA,IAAA,SAAA,QAAA,MAAA;AACA,SAAA,yBAAA,QAAA,kBAAA;AACA,eAAA;AACA,EAAA,IAAA,EAAA,eADA;AAEA,EAAA,IAFA,kBAEA;AACA,WAAA;AACA,MAAA,qBAAA,EAAA;AADA,KAAA;AAGA,GANA;AAOA,EAAA,KAAA,EAAA;AACA,IAAA,cAAA,EAAA;AACA,MAAA,IAAA,EAAA,MADA;AAEA,MAAA,QAAA,EAAA;AAFA,KADA;AAKA;AACA,IAAA,SAAA,EAAA;AACA,MAAA,IAAA,EAAA,KADA;AAEA,MAAA,QAAA,EAAA;AAFA,KANA;AAUA,IAAA,OAAA,EAAA;AACA,MAAA,IAAA,EAAA,KADA;AAEA,MAAA,QAAA,EAAA;AAFA,KAVA;AAcA,IAAA,eAAA,EAAA;AACA,MAAA,IAAA,EAAA,KADA;AAEA,MAAA,QAAA,EAAA;AAFA;AAdA,GAPA;AA0BA,EAAA,OAAA,EAAA;AACA,IAAA,aADA,2BACA;AACA,WAAA,qBAAA,GAAA,IAAA;AACA,KAHA;AAIA;AACA,IAAA,aALA,2BAKA;AACA,WAAA,YAAA,CAAA,KAAA,eAAA;AACA,KAPA;AAQA;AACA,IAAA,SATA,uBASA;AACA,WAAA,OAAA,CAAA,aAAA;AACA,KAXA;;AAYA;AACA,IAAA,aAbA,yBAaA,IAbA,EAaA;AACA,UAAA,OAAA,GAAA,KAAA,QAAA,CAAA;AACA,QAAA,IAAA,EAAA,IADA;AAEA,QAAA,IAAA,EAAA,IAFA;AAGA,QAAA,OAAA,EAAA,iBAHA;AAIA,QAAA,UAAA,EAAA,0BAJA;AAKA,QAAA,MAAA,EAAA,QAAA,CAAA,aAAA,CAAA,UAAA;AALA,OAAA,CAAA;AAOA,WAAA,UAAA,GAAA,OAAA;AACA,KAtBA;AAuBA;AACA,IAAA,YAxBA,wBAwBA,UAxBA,EAwBA;AAAA;;AACA,UAAA,IAAA,GAAA,KAAA,cAAA,GAAA,QAAA;AACA,WAAA,aAAA,CAAA,IAAA;;AAEA,MAAA,OAAA,CAAA,MAAA,CAAA,EAAA,EAAA,YAAA;AAAA,uBACA,OAAA,CAAA,4BAAA,CADA;AAAA,YACA,oBADA,YACA,oBADA,EACA;;;AACA,YAAA,IAAA,GAAA,UAAA,CAFA,CAEA;;AACA,YAAA,IAAA,GAAA,KAAA,CAAA,UAAA,CAAA,KAAA,CAAA,SAAA,EAAA,IAAA,CAAA,CAHA,CAGA;;;AACA,QAAA,oBAAA,CAAA,KAAA,CAAA,OAAA,EAAA,IAAA,EAAA,KAAA,CAAA,cAAA,GAAA,GAAA,GAAA,yBAAA,EAAA,GAAA,GAAA,CAAA,CAJA,CAIA;;AACA,QAAA,KAAA,CAAA,OAAA,CAAA;AACA,UAAA,KAAA,EAAA,MADA;AAEA,UAAA,OAAA,EAAA,KAAA,CAAA,cAAA,GAAA,MAFA;AAGA,UAAA,IAAA,EAAA;AAHA,SAAA;;AAKA,QAAA,KAAA,CAAA,qBAAA,GAAA,KAAA;;AACA,QAAA,KAAA,CAAA,UAAA,CAAA,KAAA;AACA,OAZA;AAaA,KAzCA;AA0CA,IAAA,UA1CA,sBA0CA,SA1CA,EA0CA,QA1CA,EA0CA;AACA,aAAA,QAAA,CAAA,GAAA,CAAA,UAAA,CAAA;AAAA,eAAA,SAAA,CAAA,GAAA,CAAA,UAAA,CAAA;AAAA,iBAAA,CAAA,CAAA,CAAA,CAAA;AAAA,SAAA,CAAA;AAAA,OAAA,CAAA;AACA;AA5CA;AA1BA,CAAA","sourcesContent":["<template>\r\n  <el-dialog title=\"提示\"\r\n             :visible.sync=\"sonPrintDialogVisible\"\r\n             width=\"30%\"\r\n             center>\r\n    <span>请选择导出范围</span>\r\n    <span slot=\"footer\"\r\n          class=\"dialog-footer\">\r\n      <el-button type=\"primary\"\r\n                 @click=\"exprotCurPage\">仅 本 页 导 出</el-button>\r\n      <el-button type=\"success\"\r\n                 @click=\"exprotAll\">全 部 导 出</el-button>\r\n      <el-button @click=\"sonPrintDialogVisible = false\">取 消 导 出</el-button>\r\n\r\n    </span>\r\n  </el-dialog>\r\n</template>\r\n<script>\r\nimport XLSX, { WorkSheet } from \"xlsx\";\r\nimport { getNowFormatDateForExport } from '../../util/tools'\r\nexport default {\r\n  name: \"ToolbarExport\",\r\n  data () {\r\n    return {\r\n      sonPrintDialogVisible: false\r\n    };\r\n  },\r\n  props: {\r\n    exportFileName: {\r\n      type: String,\r\n      required: true,\r\n    },\r\n    //接受父组件传值\r\n    filterVal: {\r\n      type: Array,\r\n      required: true,\r\n    },\r\n    tHeader: {\r\n      type: Array,\r\n      required: true,\r\n    },\r\n    currentPageData: {\r\n      type: Array,\r\n      required: true,\r\n    }\r\n  },\r\n  methods: {\r\n    showPrintPage () {\r\n      this.sonPrintDialogVisible = true\r\n    },\r\n    // 仅导出本页\r\n    exprotCurPage () {\r\n      this.export2Excel(this.currentPageData)\r\n    },\r\n    // 导出全部\r\n    exprotAll () {\r\n      this.$parent.exportAllData()\r\n    },\r\n    /** 加载方法 */\r\n    loadingToload (text) {\r\n      const loading = this.$loading({\r\n        lock: true,\r\n        text: text,\r\n        spinner: 'el-icon-loading',\r\n        background: 'rgba(255, 255, 255, 0.8)',\r\n        target: document.querySelector('#mainDiv')\r\n      })\r\n      this.curLoading = loading\r\n    },\r\n    // 导出Excel表格\r\n    export2Excel (exportData) {\r\n      var text = this.exportFileName + '导出中...'\r\n      this.loadingToload(text)\r\n\r\n      require.ensure([], () => {\r\n        const { export_json_to_excel } = require('../../util/Export2Excel.js') // Export2Excel.js路径\r\n        const list = exportData // 数据源\r\n        const data = this.formatJson(this.filterVal, list) // 数据为json格式\r\n        export_json_to_excel(this.tHeader, data, this.exportFileName + '(' + getNowFormatDateForExport() + ')') // 导出表格名字\r\n        this.$notify({\r\n          title: '导出成功',\r\n          message: this.exportFileName + '导出成功',\r\n          type: 'success'\r\n        })\r\n        this.sonPrintDialogVisible = false\r\n        this.curLoading.close()\r\n      })\r\n    },\r\n    formatJson (filterVal, jsonData) {\r\n      return jsonData.map(v => filterVal.map(j => v[j]))\r\n    }\r\n  }\r\n};\r\n</script>"],"sourceRoot":"src\\components"}]}